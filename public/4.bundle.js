(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{10:function(t,e,n){"use strict";function r(t={}){return Object.freeze({relative:function(t,e,n){return(e-t)/(n-t)},limit:function(t,e,n){return e<t?t:e>n?n:e},normalize:function(t,e,n){return t<e&&(t=e),t>n&&(t=n),(t-e)/(n-e)}})}n.d(e,"a",(function(){return r}))},11:function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return a}));var r=n(9);const i=10,c=5;function o(t={x:0,y:0,t:0}){let{x:e,y:n,t:r}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getTimestamp:function(){return r}})}function u(t={x:0,y:0,t:0,d:0}){let{x:e,y:n,t:r,d:i}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getTimestamp:function(){return r},getDuration:function(){return i},getFixation:function(){return{x:e,y:n}}})}function a(t={points:[]}){let{points:e}=t;return Object.freeze({detector:function(){return function(){let t=e.map(t=>t.getX()*r.c),n=e.map(t=>t.getY()*r.b);return Math.max(...t)-Math.min(...t)+(Math.max(...n)-Math.min(...n))}()>50&&function(){let t=e.map(t=>t.getX()),n=e.map(t=>t.getY());return u({x:+(t.reduce((t,e)=>t+e)/t.length).toFixed(6),y:+(n.reduce((t,e)=>t+e)/n.length).toFixed(6),t:+e[0].getTimestamp().toFixed(6),d:+(e[e.length-1].getTimestamp()-e[0].getTimestamp()).toFixed(6)})}()}})}},14:function(t,e,n){"use strict";function r(t={}){let e=0;return Object.freeze({put:function(t){caches.open("gaze").then(n=>{n.put("/gaze/"+e,new Response(t)),e+=1})},get:async function(t,e){const n=await caches.open("gaze"),r=await n.match(new Request("/gaze/"+t));r?r.json().then(t=>e(t)):e(void 0)},clear:async function(t,e){caches.delete(t).then(t=>e(t))},getKeys:async function(t,e){(await caches.open(t)).keys().then(t=>e(t))},usage:function(t){return navigator.storage.estimate()}})}n.d(e,"a",(function(){return r}))},27:function(t,e){},69:function(t,e,n){"use strict";n.r(e),n.d(e,"Record",(function(){return s}));var r=n(14),i=n(9),c=n(11),o=n(19),u=n.n(o),a=n(0),f=n(28);let l=function(t){return console.log("inspect",t.recording),t.recording?a.a`
      <button @click="${t.toggleRecord}" class="mdc-button mdc-button--unelevated">
        <i class="material-icons mdc-button__icon" aria-hidden="true">stop</i>
        <span class="mdc-button__label">Stop</span>
      </button>
    `:a.a`
      <button @click="${t.toggleRecord}" class="mdc-button mdc-button--unelevated record-button">
        <i class="material-icons mdc-button__icon" aria-hidden="true">fiber_manual_record</i>
        <span class="mdc-button__label">Record</span>
      </button>`};function d(){return(d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function s(t){let e=void 0,n=[],o=0,s=c.d,g=(Object(r.a)({}),void 0),h=function(){t.recording?t.elapsed=f.DateTime.local().diff(g).toFormat("hh:mm:ss"):g=f.DateTime.local(),t.recording=!t.recording,m(t)},m=t=>{Object(a.b)((t=>a.a`
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner">
      <div class="mdc-layout-grid__cell--span-4"></div>
      <div class="mdc-layout-grid__cell--span-4">
        <video id="player" playsinline autoplay loop muted></video>
        ${l(t)}
        ${t.elapsed}
      </div>
      <div class="mdc-layout-grid__cell--span-4"></div>
    </div>
  </div>
`)(t),document.getElementById("view"))};d(t,{toggleRecord:h,recording:!1}),m(t);return Object.freeze({connect:function(r){let a=document.createElement("canvas");a.width=1280,a.height=720;let f=a.getContext("2d"),l=new Worker("/storage.js");e=u.a.connect("http://localhost"),e.on("news",(function(e){if(e.X=e.X/i.c,e.Y=e.Y/i.b,t.recording){let t=Object(c.b)({x:e.X,y:e.Y,t:e.Timestamp});if(n.push(t),n.length===s){let t=Object(c.c)({points:n}).detector();if(t){o+=1,f.drawImage(document.getElementById("player"),0,0,f.canvas.width,f.canvas.height);let e=f.getImageData(0,0,f.canvas.width,f.canvas.height);l.postMessage({x:t.getX(),y:t.getY(),timestamp:t.getTimestamp(),pxls:e.data.buffer},[e.data.buffer]),20===o&&(o=0),n=[],s=c.d}else s++}}}))},disconnect:function(){e.disconnect(),console.log("disconnect from record")}})}},8:function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"e",(function(){return o})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return y}));var r=n(10);const i="rgba(200,0,0,0.85)",c="rgba(255,255,255,0.85)",o="rgba(255,255,255,0.85)",u="rgb(0,0,0)",a=[],f=[];for(var l=0;l<10;l++){var d=.618033988749895*l%1,s=Math.sqrt(1-.618033988749895*l%.5),g=[h=d,(m=.5)*(b=s)/((h=(2-m)*b)<1?h:2-h),h/2];a.push("hsla("+Math.round(255*g[0])+","+Math.round(100*g[1])+"%,"+Math.round(100*g[2])+"%,0.5)")}var h,m,b;for(let t=0;t<210;t++)f.push("hsla("+(209-t)+", 50%, 50%,0.5)");function y(t={}){let e=Object(r.a)({});return Object.freeze({heat:function(t){let n=e.limit(0,t,1);return 0===t?"rgba(0,0,0,0)":f[Math.round(n*(f.length-1))]}})}},9:function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"g",(function(){return f})),n.d(e,"h",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"a",(function(){return s})),n.d(e,"i",(function(){return h})),n.d(e,"e",(function(){return m})),n.d(e,"d",(function(){return b}));var r=n(8),i=n(10);const c=window.screen.width*window.devicePixelRatio,o=window.screen.height*window.devicePixelRatio;let u=Object(r.b)({}),a=Object(i.a)({});function f(t={x:0,y:0}){let{x:e,y:n}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},render:function(t,r){t.fillStyle=r,t.fillRect(e*t.canvas.width,n*t.canvas.height,.005*t.canvas.width,.005*t.canvas.width)}})}function l(t={points:[]}){let{points:e}=t;return Object.freeze({render:function(t,n){t.fillStyle=n,e.forEach((function(e){e.render(t,n)}))},renderTimeline:function(t,n,r){t.fillStyle=r,e.forEach((function(e,r){let i=0===n?e.getX():e.getY();t.fillRect(r/30*t.canvas.width,(1-i)*t.canvas.height,t.canvas.width/30,1)}))}})}function d(t={x1:0,y1:0,x2:0,y2:0}){let{x1:e,y1:n,x2:r,y2:i}=t;return Object.freeze({render:function(t,c){t.strokeStyle=c,t.beginPath(),t.moveTo(e*t.canvas.width,n*t.canvas.height),t.lineTo(r*t.canvas.width,i*t.canvas.height),t.stroke()}})}function s(t={x:0,y:0,r:0}){let{x:e,y:n,r:r}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getR:function(){return r},render:function(t,i,c){t.beginPath(),t.arc(e*t.canvas.width,n*t.canvas.height,r,0,2*Math.PI),c&&(t.fillStyle=c,t.fill()),i&&(t.strokeStyle=i,t.stroke())}})}const g=[30,15];function h(t={x:0,y:0,width:0,height:0}){let{x:e,y:n,width:i,height:c}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getWidth:function(){return i},getHeight:function(){return c},clear:function(t,e){t.fillStyle=e||r.a,t.fillRect(0,0,i,c)},tiles:function(t=g){let r=[],o={x:e,y:n},u=!1;for(;o.y<n+c;){let n={x:o.x,y:o.y,width:t[0],height:t[1]};r.push(n),o.x=n.x+n.width,o.x>=e+i&&(u=!u,o.y+=t[1],o.x=u?e-t[0]/2:0)}return r},containsPoint:function(t,r){let o=i,u=c;return!((o|u)<0)&&(!(t<e||r<n)&&(o+=e,u+=n,(o<e||o>t)&&(u<n||u>r)))},render:function(t,r,o){r&&(t.strokeStyle=r,t.strokeRect(e,n,i,c)),o&&(t.fillStyle=o,t.fillRect(e,n,i,c))}})}function m(t={tiles:[]}){let{tiles:e}=t,n=new Uint16Array(new ArrayBuffer(2*e.length)),r=new Uint16Array(new ArrayBuffer(2*e.length));return Object.freeze({getCount:function(t){return n[t]},setCount:function(t,e){n[t]=e},getCountArr:function(){return n},setCountArr:function(t){n=t},reset:function(){n=new Uint16Array(new ArrayBuffer(2*e.length)),r=new Uint16Array(new ArrayBuffer(2*e.length))},render:function(t){let i=0!==n.buffer.byteLength?n:r,c=Math.max(...i);0!==c&&e.forEach((function(e,n){if(i[n]){let r=u.heat(a.relative(0,i[n],c));e.render(t,void 0,r)}})),0!==n.buffer.byteLength&&(r=n.slice(0))}})}function b(t={}){return Object.freeze({linear:function(t,e,n,r){return(n-e)*t/r+e}})}}}]);
//# sourceMappingURL=4.bundle.js.map