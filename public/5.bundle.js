(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{10:function(t,e,n){"use strict";function i(t={}){return Object.freeze({relative:function(t,e,n){return(e-t)/(n-t)},limit:function(t,e,n){return e<t?t:e>n?n:e},normalize:function(t,e,n){return t<e&&(t=e),t>n&&(t=n),(t-e)/(n-e)}})}n.d(e,"a",(function(){return i}))},11:function(t,e,n){"use strict";n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return u}));var i=n(9);const c=10,r=5;function a(t={x:0,y:0,t:0}){let{x:e,y:n,t:i}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getTimestamp:function(){return i}})}function o(t={x:0,y:0,t:0,d:0}){let{x:e,y:n,t:i,d:c}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getTimestamp:function(){return i},getDuration:function(){return c},getFixation:function(){return{x:e,y:n}}})}function u(t={points:[]}){let{points:e}=t;return Object.freeze({detector:function(){return function(){let t=e.map(t=>t.getX()*i.c),n=e.map(t=>t.getY()*i.b);return Math.max(...t)-Math.min(...t)+(Math.max(...n)-Math.min(...n))}()>50&&function(){let t=e.map(t=>t.getX()),n=e.map(t=>t.getY());return o({x:+(t.reduce((t,e)=>t+e)/t.length).toFixed(6),y:+(n.reduce((t,e)=>t+e)/n.length).toFixed(6),t:+e[0].getTimestamp().toFixed(6),d:+(e[e.length-1].getTimestamp()-e[0].getTimestamp()).toFixed(6)})}()}})}},27:function(t,e){},68:function(t,e,n){"use strict";n.r(e),n.d(e,"Diagnosis",(function(){return h}));var i=n(9),c=n(11),r=n(8),a=n(10),o=n(19),u=n.n(o),d=n(0);let l=function(){document.getElementById("a").getContext("2d").canvas.webkitRequestFullScreen()};function s(){return(s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function h(t){let e=void 0,n=[],o=[],h=[],f=0,g=void 0,b=c.d,v=!1,y=Object(a.a)({}),w=!1,m=24,x=void 0,p=0,j=0,O=0,z=600,_=0,k=0,T=0,X=0,Y=[[.1,.1],[.9,.1],[.5,.5],[.1,.9],[.9,.9]],M=[],S=function(t,e,c,r){T=_,X=k,p=0,x=setInterval((function(){Object(i.i)({x:0,y:0,width:t.canvas.width,height:t.canvas.height}).clear(t,"#ccc"),function(t,e,c,r){m<24&&(m=Object(i.d)({}).linear(O,5,24,100)),100===O&&(_=Object(i.d)({}).linear(p,T,e,z),k=Object(i.d)({}).linear(p,X,c,z),p===z&&(m=Object(i.d)({}).linear(j,24,6,200),200===j&&(clearInterval(x),j=0,O=0,console.log("calibration end",h),setTimeout((function(){h=n.slice(20,n.length),M.push(h),h=[]}),1e3)))),Object(i.a)({x:_,y:k,r:m}).render(t,void 0,"#e36056"),Object(i.a)({x:_,y:k,r:5}).render(t,void 0,"#000")}(t,e,c),100===O?p===z?j+=10:p+=10:O+=10}),10)},E=function(){A(t);let e=document.getElementById("a").getContext("2d");w=!0,e.canvas.focus(),e.canvas.webkitRequestFullScreen(),e.save(),Object(i.i)({x:0,y:0,width:e.canvas.width,height:e.canvas.height}).clear(e,"#ccc");let n=0;Y.forEach((function(t,i){setTimeout((function(){S(e,t[0],t[1])}),n),n+=2e3})),setTimeout((function(){!function(t){let e=[],n=[];Object(i.i)({x:0,y:0,width:t.canvas.width,height:t.canvas.height}).clear(t,"#ccc"),M.forEach((function(c,r){t.lineWidth=.005*t.canvas.height,Object(i.a)({x:Y[r][0],y:Y[r][1],r:10}).render(t,"rgba(0,0,0,0.25)"),c.forEach((function(i){t.lineWidth=.001*t.canvas.height,t.strokeStyle="#95c45d",t.beginPath(),t.moveTo(Y[r][0]*t.canvas.width,Y[r][1]*t.canvas.height),t.lineTo(i.getX()*t.canvas.width,i.getY()*t.canvas.height),e.push(Y[r][0]-i.getX()),n.push(Y[r][1]-i.getY()),t.stroke()}))}));let c=Math.abs(e.reduce((function(t,e){return t+e}))/e.length),r=Math.abs(n.reduce((function(t,e){return t+e}))/n.length);console.log("erorr",100*(1-(c+r)))}(e)}),2e3*Y.length),e.restore()},A=t=>{Object(d.b)((t=>d.a`
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner">
      <div class="mdc-layout-grid__cell--span-8">
        <canvas @click="${l}" id="a" width="1280" height="720"></canvas>
      </div>
      <div class="mdc-layout-grid__cell--span-4">
        <div class="mdc-switch">
          <div class="mdc-switch__track"></div>
          <div class="mdc-switch__thumb-underlay">
            <div class="mdc-switch__thumb">
              <input @click="${t.setMode}" type="checkbox" id="basic-switch" class="mdc-switch__native-control" role="switch">
            </div>
          </div>
        </div>
        <label for="basic-switch">Detect fixations</label>
        <h5>Timeline</h5>
        <canvas id="gaze-x" width="100" height="30"></canvas>
        <canvas id="gaze-y" width="100" height="30"></canvas>
        <h5>Calibration</h5>
        <button @click="${t.calibrate}" class="mdc-button mdc-button--unelevated">
          <i class="material-icons mdc-button__icon" aria-hidden="true">adjust</i>
          <span class="mdc-button__label">Inspect calibration</span>
        </button>
      </div>
    </div>
  </div>
`)(t),document.getElementById("view"))};s(t,{setMode:function(){v=!v},calibrate:E}),A(t);return Object.freeze({connect:function(t){e=u.a.connect("http://localhost"),e.on("news",(function(e){e.X=e.X/i.c,e.Y=e.Y/i.b;let a=Object(i.g)({x:e.X,y:e.Y});if(30===n.length&&n.shift(),n.push(a),!w){if(v){let n=Object(c.b)({x:e.X,y:e.Y,t:e.Timestamp});if(o.push(n),o.length===b){let e=Object(c.c)({points:o}).detector();if(e){f+=1,20===f&&(Object(i.i)({x:0,y:0,width:t.canvas.width,height:t.canvas.height}).clear(t),f=0);let n=50*y.normalize(e.getDuration(),100,400);Object(i.a)({x:e.getX(),y:e.getY(),r:n}).render(t,r.c),g&&Object(i.f)({x1:g.getX(),y1:g.getY(),x2:e.getX(),y2:e.getY()}).render(t,r.e),g=e,o=[],b=c.d}else b++}}else Object(i.i)({x:0,y:0,width:t.canvas.width,height:t.canvas.height}).clear(t),a.render(t,r.d),Object(i.h)({points:n}).render(t,r.d);let u=document.getElementById("gaze-x").getContext("2d"),d=document.getElementById("gaze-y").getContext("2d");Object(i.i)({x:0,y:0,width:u.canvas.width,height:u.canvas.height}).clear(u),Object(i.i)({x:0,y:0,width:d.canvas.width,height:d.canvas.height}).clear(d),Object(i.h)({points:n}).renderTimeline(u,0,r.d),Object(i.h)({points:n}).renderTimeline(d,1,r.d)}}))},disconnect:function(){e.disconnect(),console.log("disconnect from diagnosis")}})}},8:function(t,e,n){"use strict";n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return y}));var i=n(10);const c="rgba(200,0,0,0.85)",r="rgba(255,255,255,0.85)",a="rgba(255,255,255,0.85)",o="rgb(0,0,0)",u=[],d=[];for(var l=0;l<10;l++){var s=.618033988749895*l%1,h=Math.sqrt(1-.618033988749895*l%.5),f=[g=s,(b=.5)*(v=h)/((g=(2-b)*v)<1?g:2-g),g/2];u.push("hsla("+Math.round(255*f[0])+","+Math.round(100*f[1])+"%,"+Math.round(100*f[2])+"%,0.5)")}var g,b,v;for(let t=0;t<210;t++)d.push("hsla("+(209-t)+", 50%, 50%,0.5)");function y(t={}){let e=Object(i.a)({});return Object.freeze({heat:function(t){let n=e.limit(0,t,1);return 0===t?"rgba(0,0,0,0)":d[Math.round(n*(d.length-1))]}})}},9:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return l})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return h})),n.d(e,"i",(function(){return g})),n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return v}));var i=n(8),c=n(10);const r=window.screen.width*window.devicePixelRatio,a=window.screen.height*window.devicePixelRatio;let o=Object(i.b)({}),u=Object(c.a)({});function d(t={x:0,y:0}){let{x:e,y:n}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},render:function(t,i){t.fillStyle=i,t.fillRect(e*t.canvas.width,n*t.canvas.height,.005*t.canvas.width,.005*t.canvas.width)}})}function l(t={points:[]}){let{points:e}=t;return Object.freeze({render:function(t,n){t.fillStyle=n,e.forEach((function(e){e.render(t,n)}))},renderTimeline:function(t,n,i){t.fillStyle=i,e.forEach((function(e,i){let c=0===n?e.getX():e.getY();t.fillRect(i/30*t.canvas.width,(1-c)*t.canvas.height,t.canvas.width/30,1)}))}})}function s(t={x1:0,y1:0,x2:0,y2:0}){let{x1:e,y1:n,x2:i,y2:c}=t;return Object.freeze({render:function(t,r){t.strokeStyle=r,t.beginPath(),t.moveTo(e*t.canvas.width,n*t.canvas.height),t.lineTo(i*t.canvas.width,c*t.canvas.height),t.stroke()}})}function h(t={x:0,y:0,r:0}){let{x:e,y:n,r:i}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getR:function(){return i},render:function(t,c,r){t.beginPath(),t.arc(e*t.canvas.width,n*t.canvas.height,i,0,2*Math.PI),r&&(t.fillStyle=r,t.fill()),c&&(t.strokeStyle=c,t.stroke())}})}const f=[30,15];function g(t={x:0,y:0,width:0,height:0}){let{x:e,y:n,width:c,height:r}=t;return Object.freeze({getX:function(){return e},getY:function(){return n},getWidth:function(){return c},getHeight:function(){return r},clear:function(t,e){t.fillStyle=e||i.a,t.fillRect(0,0,c,r)},tiles:function(t=f){let i=[],a={x:e,y:n},o=!1;for(;a.y<n+r;){let n={x:a.x,y:a.y,width:t[0],height:t[1]};i.push(n),a.x=n.x+n.width,a.x>=e+c&&(o=!o,a.y+=t[1],a.x=o?e-t[0]/2:0)}return i},containsPoint:function(t,i){let a=c,o=r;return!((a|o)<0)&&(!(t<e||i<n)&&(a+=e,o+=n,(a<e||a>t)&&(o<n||o>i)))},render:function(t,i,a){i&&(t.strokeStyle=i,t.strokeRect(e,n,c,r)),a&&(t.fillStyle=a,t.fillRect(e,n,c,r))}})}function b(t={tiles:[]}){let{tiles:e}=t,n=new Uint16Array(new ArrayBuffer(2*e.length)),i=new Uint16Array(new ArrayBuffer(2*e.length));return Object.freeze({getCount:function(t){return n[t]},setCount:function(t,e){n[t]=e},getCountArr:function(){return n},setCountArr:function(t){n=t},reset:function(){n=new Uint16Array(new ArrayBuffer(2*e.length)),i=new Uint16Array(new ArrayBuffer(2*e.length))},render:function(t){let c=0!==n.buffer.byteLength?n:i,r=Math.max(...c);0!==r&&e.forEach((function(e,n){if(c[n]){let i=o.heat(u.relative(0,c[n],r));e.render(t,void 0,i)}})),0!==n.buffer.byteLength&&(i=n.slice(0))}})}function v(t={}){return Object.freeze({linear:function(t,e,n,i){return(n-e)*t/i+e}})}}}]);
//# sourceMappingURL=5.bundle.js.map